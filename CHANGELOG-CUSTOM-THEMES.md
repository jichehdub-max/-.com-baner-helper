# Changelog: Кастомные темы и вкладки

## Version 1.0.9 - Автоматический контраст и градиенты

### Новые возможности

#### 1. Автоматический контрастный текст
- Система автоматически определяет цвет текста (белый/чёрный) на основе яркости фона
- Использует формулу luminance для вычисления яркости
- Гарантирует читаемость текста при любом цвете фона
- Светлый фон → чёрный текст, тёмный фон → белый текст

#### 2. Градиентный режим для кастомных тем
- Чекбокс "Градиентный режим" в настройках темы
- Создаёт анимированный градиент фона
- Плавная анимация 10 секунд
- Динамическое создание CSS keyframes
- Можно включать/выключать для каждой темы отдельно

#### 3. Улучшенная функция яркости
- Функция `adjustBrightness()` теперь работает с отрицательными значениями
- Используется `Math.max(0, ...)` для предотвращения отрицательных RGB значений
- Позволяет затемнять цвета, а не только осветлять

### Технические изменения

#### JavaScript (`floating-panel/floating-panel.js`)
- Добавлена функция `getContrastColor(hexColor)`:
  - Конвертирует hex в RGB
  - Вычисляет luminance по формуле (0.299*R + 0.587*G + 0.114*B)/255
  - Возвращает #1a1a1a или #ffffff в зависимости от яркости
  
- Обновлена функция `applyCustomTheme()`:
  - Добавлен параметр `gradient`
  - Автоматическое определение цвета текста
  - Создание/удаление градиентной анимации
  - Динамическое создание `<style>` элемента с keyframes
  
- Обновлена функция `saveCustomTheme()`:
  - Сохраняет параметр `gradient`
  
- Обновлена функция `loadCustomTheme()`:
  - Загружает параметр `gradient`
  - Устанавливает состояние чекбокса

- Улучшена функция `adjustBrightness()`:
  - Добавлен `Math.max(0, ...)` для работы с отрицательными значениями

#### HTML структура
- Добавлен чекбокс "Градиентный режим" в панель тем
- Добавлена подсказка о работе градиента

### Использование

#### Создание темы с градиентом:
1. Откройте панель тем → вкладка "Темы"
2. Выберите цвета
3. Включите "Градиентный режим"
4. Нажмите "Применить" для предпросмотра
5. Нажмите "Сохранить тему"

#### Автоматический контраст:
- Просто выберите любой цвет фона
- Система автоматически подберёт читаемый цвет текста
- Работает как для светлых, так и для тёмных тем

### Примеры

**Светлая тема:**
- Фон: #f0f0f0 → Текст: #1a1a1a (чёрный)

**Тёмная тема:**
- Фон: #0a0a0a → Текст: #ffffff (белый)

**Градиентная тема:**
- Фон: #1a1f2e + Градиент: ✓ → Анимированный градиент

---

## Version 1.0.8 - Добавлены кастомные темы и вкладки

### Новые возможности

#### 1. Разделение на вкладки
- Панель тем теперь имеет две вкладки: **Темы** и **Шейдеры**
- Удобная навигация между настройками тем и шейдеров
- Каждая вкладка имеет свой набор инструментов

#### 2. Создание кастомных тем
- Возможность создавать собственные цветовые темы
- Настройка трёх параметров:
  - Основной цвет (primary)
  - Вторичный цвет (secondary)
  - Цвет фона (background)
- Сохранение кастомных тем в локальное хранилище
- Загрузка и удаление сохранённых тем
- Применение кастомных тем в реальном времени

#### 3. Новая позиция панели кнопок
- Панель кнопок перемещена в центр правой стороны экрана
- Теперь находится на уровне постов (как на скриншоте)
- Использует `bottom: 50%` и `transform: translateY(50%)` для центрирования

### Технические изменения

#### JavaScript (`floating-panel/floating-panel.js`)
- Добавлены функции:
  - `saveCustomTheme()` - сохранение кастомной темы
  - `loadCustomTheme()` - загрузка кастомной темы
  - `deleteCustomTheme()` - удаление кастомной темы
  - `applyCustomTheme()` - применение кастомной темы
  - `loadSavedCustomThemesList()` - загрузка списка тем
  - `adjustBrightness()` - изменение яркости цвета
  - `hexToRgba()` - конвертация hex в rgba
- Добавлена система вкладок с переключением
- Обновлена структура HTML панели тем

#### CSS (`floating-panel/floating-panel.css`)
- Добавлены стили для вкладок (`.itd-panel-tabs`, `.itd-tab`)
- Добавлена поддержка `input[type="color"]`
- Изменена позиция панели кнопок на центр экрана
- Обновлена высота контента панели для учёта вкладок

### Использование

#### Создание кастомной темы:
1. Откройте панель тем
2. Перейдите на вкладку "Темы"
3. Введите название темы
4. Выберите цвета с помощью color picker
5. Нажмите "Сохранить тему"
6. Нажмите "Применить" для активации

#### Работа с шейдерами:
1. Откройте панель тем
2. Перейдите на вкладку "Шейдеры"
3. Все функции шейдеров остались без изменений
